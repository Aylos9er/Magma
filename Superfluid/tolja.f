       SUBROUTINE TOLJA (X, T, P, V, GDIVP)
CC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C        CALCULATION OF ENTHALPY, ENTROPY, HEAT CAPACITY,              C
C                         GIBBS FREE ENERGY, (MU0/RT),                 C
C                            ACTIVITY AND FUGACITY                     C
C                  FOR A FLUID MIXTURE WITH COMPOSITION X              C
C                           AT P (bar) AND T (K)                       C
C                                                                      C
C        ****        when pressure is higher than 5 kbar.              C
C                                                                      C
C ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ C
C                                                                      C
C             Anatoly B. Benoloshko,  and  Surendra K. Saxena          C
C             ---------------------        ------------------          C
C                     Planetary Geochemistry                           C
C                     Uppsala University                               C
C                     Uppsala                                          C
C                     SWEDEN                                           C
C                                                                      C
C ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ C
C                                                                      C
CC  Fluid Model:                                                       C
C      C-H-O-S-N-Ar One-Fluid Model:                                   C
C                        Belonoshko-Saxena (1991a)                     C
C                        Belonoshko-Saxena (1992b)                     C
C                        Belonoshko (1992)                             C
C                        Belonoshko-Saxena (1992)                      C
C                        Belonoshko-Shi-Saxena (1992)                  C
C                                                                      C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CC
       EXTERNAL TVPM
       PARAMETER (NGAS = 13 )
       DIMENSION X (NGAS), V0MEG(NGAS), V0FIF(NGAS)
       DATA V0MEG /6.65,10.94,10.46,9.46,7.97,3.92,7.19,10.92,14.22,
     >             11.0, 9.0, 8.16, 7.77/
       DATA V0FIF /12.4,20.8,20.17,18.39,15.5,8.8,14.4,20.8,27.2,20.8,
     >             18.0,15.3,15.4/
C
       EPS = 0.00001
       V0  = 20.0
       P5 = 5000.0
       CALL NR (TVPM, EPS, X,T,P5,V0,V5)

       IF ( P .LE. 50000.0) THEN
          V0 = 0.0
          DO 1 I = 1, NGAS
1          V0 = V0 + X(i)*V0FIF(i)
       END IF
       IF ( P .GT. 50000.0) THEN
          V0 = 0.0
          DO 2 I = 1, NGAS
2          V0 = V0 + X(I)*V0MEG(i)
       END IF

       CALL NR (TVPM, EPS, X,T,P ,V0,V )
       CALL VDP (TVPM, EPS, X,T, V5, V, VDPINT)
       GDIVP = VDPINT
C
       RETURN
       END

CCC
       SUBROUTINE NR (FUNCT, EPS, X,T,P,V0,V)
       PARAMETER (NGAS = 13)
       DIMENSION X(NGAS)
       EXTERNAL FUNCT
C
       RT = 8.31451*T
       VID = RT/P*10.0
       VJ  = V0
       PTRUE = P

1       CALL FUNCT (X, T,VJ, PJ)
        CALL FUNCTS(FUNCT, X, T,VJ, PJS)
        VJ1 = (PTRUE - PJ)/PJS + VJ

        IF (ABS(VJ1-VJ) .GT. 50.0) THEN
            V = VID
            RETURN
        END IF

        IF (ABS((VJ-VJ1)/VJ1) .LT. EPS) THEN
            V = VJ1
            RETURN
        ELSE
            VJ = VJ1
            GOTO 1
        END IF
C
        RETURN
        END

CCC
        SUBROUTINE FUNCTS ( FUNCT,X, T, V, PS)
        PARAMETER (NGAS = 13)
        DIMENSION X(NGAS)
        EXTERNAL FUNCT
C
        DV = 0.001*V
        VM = V -DV
        VP = V +DV
        CALL FUNCT (X, T, VM, PM)
        CALL FUNCT (X, T, VP, PP)
        PS = (PP-PM)/2.0/DV
C
        RETURN
        END

CCC
        SUBROUTINE ASE (X, ALX, SGMX, EPSKX)
C
        PARAMETER (NGAS = 13)
        DIMENSION ALPHA(NGAS), EPSK(NGAS), SIGMA(NGAS), X(NGAS)
        DIMENSION ALIJ(NGAS,NGAS),EPSKIJ(NGAS,NGAS), SGMIJ(NGAS,NGAS)
C
        DATA ALPHA / 12.75,13.9,14.05,14.48,14.45,13.34,
     >                12.69,13.241,13.400,13.470,13.2600,13.4500, 13.0/
        DATA  EPSK / 446.7,198.634,140.941,90.805,99.495,25.144,
     >           109.000, 263.50, 248.9, 272.48, 107.2, 293.61, 122.0 /
        DATA SIGMA / 2.844, 3.6963,3.7165,3.6531,3.3688,2.9780,
     >     3.36294, 3.71319, 4.15500, 3.68989, 3.68514, 3.23415, 3.431/
        DATA ALIJ/
     >12.75,13.31,13.38,13.59,13.57,13.04,12.72,12.99,13.07,13.11,
     >13.00,13.10,12.87,13.31,13.90,13.97,14.19,14.17,13.62,13.28,
     >13.57,13.65,13.68,13.58,13.67,13.44,13.38,13.97,14.05,14.26,
     >14.25,13.69,13.35,13.64,13.72,13.76,13.65,13.75,13.51,13.59,
     >14.19,14.26,14.48,14.46,13.90,13.56,13.85,13.93,13.97,13.86,
     >13.96,13.72,13.57,14.17,14.25,14.46,14.45,13.88,13.54,13.83,
     >13.92,13.95,13.84,13.94,13.71,13.04,13.62,13.69,13.90,13.88,
     >13.34,13.01,13.29,13.37,13.40,13.30,13.39,13.17,12.72,13.28,
     >13.35,13.56,13.54,13.01,12.69,12.96,13.04,13.07,12.97,13.06,
     >12.84,12.99,13.57,13.64,13.85,13.83,13.29,12.96,13.24,13.32,
     >13.36,13.25,13.35,13.12,13.07,13.65,13.72,13.93,13.92,13.37,
     >13.04,13.32,13.40,13.43,13.33,13.42,13.20,13.11,13.68,13.76,
     >13.97,13.95,13.40,13.07,13.36,13.43,13.47,13.36,13.46,13.23,
     >13.00,13.58,13.65,13.86,13.84,13.30,12.97,13.25,13.33,13.36,
     >13.26,13.35,13.13,13.10,13.67,13.75,13.96,13.94,13.39,13.06,
     >13.35,13.42,13.46,13.35,13.45,13.22,12.87,13.44,13.51,13.72,
     >13.71,13.17,12.84,13.12,13.20,13.23,13.13,13.22,13.00/
       DATA EPSKIJ/
     >446.7,297.9,250.9,201.4,210.8,106.0,220.7,343.1,333.4,348.9,
     >218.8,362.2,233.4,297.9,198.6,167.3,134.3,140.6, 70.7,147.1,
     >228.8,222.4,232.6,145.9,241.5,155.7,250.9,167.3,140.9,113.1,
     >118.4, 59.5,123.9,192.7,187.3,196.0,122.9,203.4,131.1,201.4,
     >134.3,113.1, 90.8, 95.1, 47.8, 99.5,154.7,150.3,157.3, 98.7,
     >163.3,105.3,210.8,140.6,118.4, 95.1, 99.5, 50.0,104.1,161.9,
     >157.4,164.7,103.3,170.9,110.2,106.0, 70.7, 59.5, 47.8, 50.0,
     > 25.1, 52.4, 81.4, 79.1, 82.8, 51.9, 85.9, 55.4,220.7,147.1,
     >123.9, 99.5,104.1, 52.4,109.0,169.5,164.7,172.3,108.1,178.9,
     >115.3,343.1,228.8,192.7,154.7,161.9, 81.4,169.5,263.5,256.1,
     >268.0,168.1,278.1,179.3,333.4,222.4,187.3,150.3,157.4, 79.1,
     >164.7,256.1,248.9,260.4,163.3,270.3,174.3,348.9,232.6,196.0,
     >157.3,164.7, 82.8,172.3,268.0,260.4,272.5,170.9,282.8,182.3,
     >218.8,145.9,122.9, 98.7,103.3, 51.9,108.1,168.1,163.3,170.9,
     >107.2,177.4,114.4,362.2,241.5,203.4,163.3,170.9, 85.9,178.9,
     >278.1,270.3,282.8,177.4,293.6,189.3,233.4,155.7,131.1,105.3,
     >110.2, 55.4,115.3,179.3,174.3,182.3,114.4,189.3,122.0/
       DATA SGMIJ /
     >2.844,3.270,3.280,3.249,3.106,2.911,3.103,3.279,3.500,3.267,
     >3.265,3.039,3.138,3.270,3.696,3.706,3.675,3.533,3.337,3.530,
     >3.705,3.926,3.693,3.691,3.465,3.564,3.280,3.706,3.717,3.685,
     >3.543,3.347,3.540,3.715,3.936,3.703,3.701,3.475,3.574,3.249,
     >3.675,3.685,3.653,3.511,3.316,3.508,3.683,3.904,3.671,3.669,
     >3.444,3.542,3.106,3.533,3.543,3.511,3.369,3.173,3.366,3.541,
     >3.762,3.529,3.527,3.301,3.400,2.911,3.337,3.347,3.316,3.173,
     >2.978,3.170,3.346,3.567,3.334,3.332,3.106,3.204,3.103,3.530,
     >3.540,3.508,3.366,3.170,3.363,3.538,3.759,3.526,3.524,3.299,
     >3.397,3.279,3.705,3.715,3.683,3.541,3.346,3.538,3.713,3.934,
     >3.702,3.699,3.474,3.572,3.500,3.926,3.936,3.904,3.762,3.567,
     >3.759,3.934,4.155,3.922,3.920,3.695,3.793,3.267,3.693,3.703,
     >3.671,3.529,3.334,3.526,3.702,3.922,3.690,3.688,3.462,3.560,
     >3.265,3.691,3.701,3.669,3.527,3.332,3.524,3.699,3.920,3.688,
     >3.685,3.460,3.558,3.039,3.465,3.475,3.444,3.301,3.106,3.299,
     >3.474,3.695,3.462,3.460,3.234,3.333,3.138,3.564,3.574,3.542,
     >3.400,3.204,3.397,3.572,3.793,3.560,3.558,3.333,3.431/
CC

C
         AX = 0.0
         BX = 0.0
         CX = 0.0
         xex = 1.e-8 
         DO 3 I = 1,NGAS
         if ( abs(x(i)) .le. xex ) go to 3
         DO 4 J = 1,NGAS
         if ( abs( x(j)) .le. xex) go to 4
         xxs3 = X(I)*X(J)*SGMIJ(I,J)**3
           AX = AX + xxs3*EPSKIJ(I,J)
           BX = BX + xxs3
           CX = CX + xxs3*ALIJ(I,J)*EPSKIJ(I,J)
   4     CONTINUE
   3     CONTINUE
C
         SGMX  = BX**0.333333333
         EPSKX = AX/BX
         ALX   = CX/AX
C
         RETURN
         END

CCC
        SUBROUTINE TVPM ( X, T, V, P)
        PARAMETER (NGAS = 13)
        DIMENSION  XC (29), X (NGAS)
        DATA XC /
     >    0.49379340772561688, 1.77136719000011591,-1.24397358740699658,
     >   -8.22738223585147906, 1.26639755360917096, 1.71431494383712232,
     >   18.85767400958713600,-0.64967289865577738, 1.10631892859961082,
     >   3.43201986557894275,-11.61223156310191462,-24.0910798733673468,
     >    7.15468164992105906, 4.35243253136828275, 7.40801022796371711,
     >   -0.43490428159049076,-5.05471913647956932,-8.41696486054619399,
     >    2.81828771146679119,-5.20493168328355048, 2.65003464989916641,
     >   -1.17589498191260817, 1.00911476826150680, 1.18264255424103514,
     >  0.1021732463251438182,-0.63676820398636927, 0.60142122204215066,
     >    3.95204218076118927,  -15.63920064084153890/

C
       CALL ASE (X, ALX, SGMX, EPSKX)
       edeps = 1.0/epskx
       sgmx3 = sgmx**3
       PCOEFF = 0.06022/8.31451*SGMX3*edeps
       TCOEFF = edeps
       VCOEFF = 10.0/6.022/SGMX3
C
       TI  = T * TCOEFF
       TI2 = TI*TI
       TI3 = TI2*TI
       VI  = V * VCOEFF
       ALI = ALX
       ti100  = ti2/100.0
       ti1000 = ti3/10000.0
C
       A = XC( 1) + XC( 2)*TI + XC(3)*TI100+XC(15)*ti1000
       B = XC( 4) + XC( 5)*TI + XC(6)*ti100+XC(16)*ti1000
       C = XC( 7) + XC( 8)*TI + XC(9)*ti100+XC(17)/100000.0*TI3
       F = XC(18) + XC(19)*TI + XC(20)*ti100+XC(21)*ti1000
       G = XC(28)/10.0 + XC(29)/100.0*TI
       D = XC(10)/10+XC(11)/1000*tI+XC(22)/TI+XC(24)/10*VI+XC(25)/VI/10
       E = XC(12)/100+XC(13)/1000*TI+XC(23)/TI+XC(26)/10*VI+XC(27)/VI/10
C
       PC = A/(VI-G) + B/VI**2 +F/VI**3 + C/VI**XC(14)
       ALK = 1.0 + D*(ALI-12.75)+E*(ALI-12.75)**2
       PC = PC*ALK
       P = PC/PCOEFF
C
        RETURN
        END

CCC
       SUBROUTINE VDP (FUNCT, EPS, X,T, VST, VFIN, VDPINT)
       PARAMETER (NGAS = 13)
       DIMENSION X (NGAS)
       EXTERNAL FUNCT
C
        CALL FUNCT (X, T, VFIN,PFIN)
        CALL FUNCT (X, T, VST ,PST )
c                VDPINT = (PFIN*VFIN -PST*VST + S1)/10.0
        CALL FLINT (X, T, VFIN, PVINTF)
        CALL FLINT (X, T, VST , PVINTS)
        s1 = pvints - pvintf
        vdpint = (pfin*vfin - pst*vst + s1)/10.0
C
       RETURN
       END

CCC
        SUBROUTINE FLINT ( X, T, V, PVINT)
        PARAMETER (NGAS = 13)
        DIMENSION  XC (29), X (NGAS)
        DATA XC /
     >    0.93505310752561688, 1.73699892000011591,-1.30975098740699658,
     >   -9.14208223585147906, 1.12375121360917096, 1.94532994383712232,
     >   18.05270668458713600,-0.60332346345947818, 0.97658909559961082,
     >    3.57911846557894275,-9.81360148740191462,-22.7287168733673468,
     >    6.22413763992105906, 4.38140919236828275, 4.85395992796371711,
     >   -0.57662210159049076,-4.11150218637956932,-6.64748141694619399,
     >    2.71569335746679119,-4.78315896838355048, 2.18540232889916641,
     >   -1.03805953902260817, 0.91537388843150680, 0.90857123024103514,
     > -0.0922267363251438182,-0.60401350198636927, 0.64619486687215066,
     >       2.89574909131718927,     -11.34438696840113890/

C
         CALL ASE (X, ALX, SGMX, EPSKX)
         PCOEFF = 0.06022/8.31451*SGMX**3/EPSKX
         TCOEFF = 1.0/EPSKX
         VCOEFF = 10.0/6.022/SGMX**3
C
        TI = T * TCOEFF
        TI2 = TI*TI
        TI3 = TI2*TI
        VI = V * VCOEFF
        ALI = ALX
C
        X24 = XC(24)/10.0
        X25 = XC(25)/10.0
        X26 = XC(26)/10.0
        X27 = XC(27)/10.0
        AL1 = ALI - 12.75
C
       A = XC( 1) + XC( 2)*TI + XC(3)/100.0*TI2+XC(15)/10000.0*TI3
       B = XC( 4) + XC( 5)*TI + XC(6)/100.0*TI2+XC(16)/10000.0*TI3
       C = XC( 7) + XC( 8)*TI + XC(9)/100.0*TI2+XC(17)/100000.0*TI3
       F = XC(18) + XC(19)*TI + XC(20)/100.0*TI2+XC(21)/10000.0*TI3
       G = XC(28)/10.0 + XC(29)/100.0*TI
       DT = XC(10)/10+XC(11)/1000*tI+XC(22)/TI
       ET = XC(12)/100+XC(13)/1000*TI+XC(23)/TI
C
       al12 = al1**2
       FIRST = 1.0 + DT*AL1 + ET*AL12
       SECND = X24*AL1 + X26*AL12
       THIRD = X25*AL1 + X27*AL12
       vig = vi - g
       avi = alog(vi)
       avig = alog(vig)
       edvi = 1.0/vi
       edvi2 = edvi**2
       edvi3 = edvi2*edvi
       edvi4 = edvi3*edvi
C
       A1 = A*AVIG
       A2 = A*( VI + G*AVIG) 
       A3 = A/G*(AVIG-aVI )
C
       B1 = -B*edvi
       B2 = B*AVI
       B3 = -0.5*B*edvi2
C
       F1 = -0.5*F*edvi2
       F2 = -F*edvi
       F3 = -F/3.0*edvi3
C
       AM = XC(14)
       C1 = C/(1.0-AM)*VI**(1.0-AM)
       C2 = C/(2.0-AM)*VI**(2.0-AM)
       C3 = -C/AM*VI**(-AM)
C
       AI1 = (A1+B1+F1+C1)*FIRST
       AI2 = (A2+B2+F2+C2)*SECND
       AI3 = (A3+B3+F3+C3)*THIRD
C
       AICOM = AI1 + AI2 + AI3
C
       PVINT = AICOM /(PCOEFF*VCOEFF)
C
       RETURN
       END









